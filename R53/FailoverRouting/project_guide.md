# Using R53 and Failover Routing

This mini-project steps through how to create Failover routing and private hosted zones. Be advised that to step through this project a registered domain of your own is required which falls apart from the free tier plan. <br/>

1 - In order to get started, make sure you're logged in as the IAM admin user of your organization in the us-east-1 AWS region. <br/>

2 - Next, we will need to create some infrastructure to complete this project. We will make things faster and we will deploy a CloudFormation template. <br/>

3 - Once the CloudFormation stack has moved to completed state, some infrastructures have been created: the most importat is the public EC2 Instance we will work with, so move to the EC2 console. A public instance should be visible. <br/>

4 - We also need to give this instance an elastic IP address so it has an elastic public IPv4 address, so in the menu on the left scroll down to the bottom and under 'Security' select 'Allocate Elastic IP address'. Make sure the us-east-1 region is selected and click on 'Alocate' at the bottom of the page. Next, we will associate this elastic IP address to the instance so select the IP address, click on 'Actions' and next select 'Associate Elastic IP address'. Under 'Resource type', make sure 'Instance' is selected. Below, pick the instance created via the CloudFormation template and under 'Private IP address' pick an IP address and check the 'Reassociation' box so Elastic IP addresses can be reassociated. Finish up by clicking on 'Associate', so now our EC2 Instance has been alocated with an elastic IPv4 address. <br/>

5 - Now, we will configure failover DNS so the EC2 Instance is the primary record (a S3 bucket will run as the backup of the instance in case it fails), so move to the S3 console and click on 'Create bucket' and configure it as a Static Website. This step has been extensively covered in the previous projects so we will step through the main parts of its creation: enter a name for the bucket (with the same DNS name of the DNS record), uncheck the block public access option, acknowledge it and scroll down to the bottom and click on 'Create bucket'. Next, select the S3 bucket, move to 'Properties', scroll down to the bottom and click on 'Edit' next to 'Static Website Hosting'. There, we will enter index.html attached to the repo. Additionally, we will change the permissions of the S3 bucket by moving 'Policy' within the 'Properties' tab and paste there the Policy content attached to the repo so it is publicly accessible. <br/>

6 - Once the S3 bucket has been successfully created and holder of a Static Website, move to the Route53 service where we will create a healthcheck as well as a DNS record. On the menu on the left, click on 'HealthChecks', next click on 'Create HealthCheck'. Enter a name for the healthcheck, scroll down and specify the endpoint by IP address, so enter the IP address of the EC2 Instance (the Elastic IP address as we set previously to alocate it with an Elastic IP address). In 'Path', enter 'index.html'. Next, expand 'Advanced configuration' and check the 'Request interval' is set to 10 seconds so it reacts as fast as possibe. Click on 'Next', and as we do not want to be notified if an alarm raises leave it as 'No' and click on 'Create health check'. It will take some minutes until the health check is created successfully. <br/>

7 - Now, we need to create the failover record, so locate 'Hosted zones' in the menu on the left on the Route53 console, pick the Hosted zone of the DNS domain name and click on 'Create record'. You can pick between the 'wizard' or 'quick start' record type, the latter addressed to set advanced features on the record. Pick the first so we will make things simplier, in 'Choose routing policy' select 'Failover', click on 'Next'. For the 'Record name' enter 'www' and as TTL select 60 seconds, scroll down and we are going to define some failover records. MINUTE 11.15

